# Chris

A personal coding project workflow manager. Takes software ideas from first thought to shipped code through a structured, repeatable process — managing git, spawning agents, and coordinating across multiple repos.

```
/wf-new → /wf-prd → /wf-spec → /wf-tasks → /wf-build → /wf-review → /wf-done
```

Works from the Claude CLI at your desk.

---

## What Chris Does

- **Workflow stages** — each step produces a document that feeds the next: PRD → Spec → Tasks → Build → Review → Done
- **Multi-repo projects** — a single project can span multiple codebases; Chris coordinates them all
- **Git management** — creates branches, sets up worktrees for concurrent projects, commits in conventional style, opens draft PRs
- **Agent orchestration** — spawns Claude-driven agent sessions to do the actual building; runs an architect pass before each build and a critic agent before each review
- **Parallel execution** — tasks tagged `[P]` can be spawned as concurrent sub-agents when their dependencies are met
- **Standards injection** — integrates with AgentOS to load indexed project standards into every agent brief automatically
- **Build handoffs** — each completed task writes a `handoff.json` capturing decisions made, files changed, and open questions for the next agent
- **Self-hosting** — Chris manages its own development through the same workflow

---

## Concepts

**Project** — a unit of work, defined by a PRD. Not 1:1 with a repo. One project can touch many repos. Metadata lives in `~/Code/chris/projects/<slug>/`.

**Repo** — source code at `~/Code/<repo-name>/`. Has a `AGENTS.md` that any agent loads at session start for instant context. One repo can be part of many concurrent projects.

---

## Directory Structure

```
~/Code/
├── .chris-worktrees/           ← isolated checkouts for concurrent projects
│   └── <project-slug>/
│       └── <repo-name>/
│
├── chris/                      ← this repo (public tool)
│   ├── AGENTS.md               ← Chris's own repo context
│   ├── skills/                 ← /wf-* skill source files
│   ├── templates/              ← blank doc templates
│   ├── README.md
│   └── GUIDE.md
│
├── chris/projects/             ← private git repo (your personal project data)
│   └── <project-slug>/
│       ├── PRD.md
│       ├── SPEC.md
│       ├── TASKS.md
│       ├── status.json
│       ├── handoffs/           ← TASK-NNN.json written by each build agent
│       ├── research/
│       └── release/            ← generated by /wf-done
│
└── <repo-name>/                ← your code repos (siblings of chris/)
    ├── AGENTS.md               ← stable: Purpose, Conventions, Key Files
    ├── CONTEXT.md              ← evolving: Current Focus, Recent Decisions, Open Questions
    └── agent-os/               ← optional: AgentOS standards directory
        └── standards/
            └── index.yml
```

---

## Workflow Skills

Each `/wf-*` command is a Claude CLI slash command, available in any session.

| Command | What it does |
|---------|-------------|
| `/wf-new [name]` | Create a new project. Optionally scaffold a new repo. |
| `/wf-prd` | Write a Product Requirements Document interactively. |
| `/wf-spec` | Generate a technical spec from the PRD. |
| `/wf-tasks` | Break the spec into ordered tasks. Identify repos. Set up branches. |
| `/wf-build` | Spawn an agent for the next task. Manages git, loads context. |
| `/wf-review` | Review diff vs spec + tasks. On pass: push + open draft PR. |
| `/wf-done` | Close project: generate release artifacts, clean up git, archive. |
| `/wf-status` | Show all projects and their current stage. |
| `/wf-research [topic]` | Research a topic at any stage. Saves findings to project. |

---

## Setup

### 1. Clone this repo

```bash
git clone https://github.com/<your-username>/chris ~/Code/chris
```

### 2. Install skills globally

Symlink workflow and guide skills into `~/.claude/commands/` so they're available in every Claude session:

```bash
for skill in ~/Code/chris/skills/wf-*/SKILL.md ~/Code/chris/skills/chris-guide/SKILL.md; do
  name=$(basename $(dirname $skill))
  ln -sf "$skill" ~/.claude/commands/${name}.md
done
```

Edits to these skill files take effect immediately — no reinstall needed.

### OpenAI/Codex mirror

Chris also supports an OpenAI/Codex-facing mirror under `agents/skills/`.

- Canonical context file: `AGENTS.md`
- Tracked mirror source in this repo: `~/Code/chris/agents/skills`
- OpenAI skill target in consuming repos: `.agents/skills`
- Global Codex install target: `~/.codex/skills/chris`
- `agents/commands/` is intentionally omitted in v1 to keep scope lean

Install Codex skills globally:

```bash
mkdir -p ~/.codex/skills/chris
for skill_dir in ~/Code/chris/agents/skills/*; do
  name=$(basename "$skill_dir")
  ln -sfn "$skill_dir" ~/.codex/skills/chris/${name}
done
```

### 3. Initialise Chris

Open any Claude session and run:

```
/wf-init
```

This creates the `projects/` directory, sets up the meta-projects, and verifies your `gh` CLI auth.

### 4. Set up the private projects repo *(manual step)*

Your `projects/` directory contains all your personal project data — PRDs, specs, tasks, research. It should be a separate private GitHub repo:

```bash
cd ~/Code/chris/projects
git init
git add .
git commit -m "chore: init projects repo"
gh repo create chris-projects --private --source=. --push
```

Or create the repo on GitHub first and then:

```bash
git remote add origin git@github.com:<your-username>/chris-projects.git
git push -u origin main
```

This repo is excluded from the public `chris/` repo via `.gitignore`.

## AGENTS.md + CONTEXT.md — Repo Briefs

Every repo you work in should have an `AGENTS.md` (stable context) and a `CONTEXT.md` (evolving context). Agents read both at session start.

**`AGENTS.md`** — stable, changes only on architectural decisions:
```yaml
---
name: My API
slug: my-api
repo: ~/Code/my-api
stack: [TypeScript, Bun]
stage: build
install_cmd: bun install
default_branch: main
---

## Purpose
What this repo does and why.

## Conventions
Key patterns to follow.

## Key Files
- src/index.ts — entry point
```

**`CONTEXT.md`** — updated by each build agent on task completion:
```markdown
## Current Focus
What's being worked on right now.

## Recent Decisions
Key decisions made in recent tasks — keeps the next agent from re-litigating closed decisions.

## Open Questions
Unresolved decisions or things to revisit.
```

`/wf-new` creates both files for new repos. For existing repos, copy from `~/Code/chris/templates/`.

Child projects that Chris spawns up create their own `.claude/` and `.agents/` runtime folders. Before making your first commit in any such repo, ensure both entries are present in that repo's `.gitignore` so local agent session data stays untracked.

---

## Git Conventions

Chris manages git throughout the workflow:

- **One branch per project**: `chris/<project-slug>` (e.g., `chris/auth-overhaul`)
- **Commits**: conventional style — `feat:`, `fix:`, `docs:`, `chore:`, `refactor:`
- **Concurrent projects**: if two projects touch the same repo, git worktrees keep them isolated
- **PRs**: draft PRs opened automatically by `/wf-review` when it passes

---

## Multiple Concurrent Projects

Chris is designed for running several projects at once. If two projects both touch the same repo, it automatically uses git worktrees to keep them isolated:

```
~/Code/.chris-worktrees/
  auth-overhaul/
    api/          ← branch: chris/auth-overhaul
  mobile-v2/
    api/          ← branch: chris/mobile-v2
    mobile-app/   ← branch: chris/mobile-v2
```

If the projects overlap on the same files, Chris notifies you immediately and flags the risk at review time — but doesn't stop work.

---

## Meta-Projects

Chris eats its own cooking:

- `projects/chris/` — tracks Chris's own development (PRD, SPEC, TASKS, releases)
- `projects/workflow-improvements/` — a low-friction notebook for anything that feels clunky or could be better

---

## Full Docs

- `GUIDE.md` — detailed walkthrough of every workflow stage
- `skills/chris-guide/SKILL.md` — comprehensive workflow/system reference
- `templates/PRD.md` and `templates/SPEC.md` — canonical planning templates

## Contributor Checks

Validate Claude/Codex skill parity before opening a PR:

```bash
./scripts/check-skill-parity.sh
```
